{"ast":null,"code":"import * as actionTypes from './actionTypes';\nimport { getSongDetail, getSongPlayUrl } from '@/service/player'; // 歌曲详情Action\n\nconst changeCurrentSongAction = res => ({\n  type: actionTypes.CHANGE_CURRENT_SONG,\n  currentSong: res\n}); // 当前歌曲索引Action\n\n\nconst changeSongIndexAction = res => ({\n  type: actionTypes.CHANGE_CURRENT_SONG_INDEX,\n  currentSongIndex: res\n}); // 歌曲列表Action\n\n\nconst changePlayListAction = res => ({\n  type: actionTypes.CHANGE_PLAY_LIST,\n  playList: res\n});\n\nexport const getSongDetailAction = id => {\n  return (dispatch, getState) => {\n    // 1、根据id查找palyList里是否有该歌曲\n    const playList = getState().player.playList;\n    const songIndex = playList.findIndex(song => song.id === id);\n\n    if (songIndex !== -1) {\n      // 2、找到歌曲\n      dispatch(changeSongIndexAction(songIndex));\n      changeCurrentSongAction(playList[songIndex]);\n    } else {\n      // 3、没找到歌曲\n      // 请求数据\n      getSongDetail(id).then(res => {\n        const song = res.songs && res.songs[0];\n        playList.push(song);\n        dispatch(changePlayListAction(playList));\n        let songIndex = playList.length - 1;\n        dispatch(changeSongIndexAction(songIndex));\n        dispatch(changeCurrentSongAction(playList[songIndex]));\n      });\n    }\n  };\n}; // 歌曲音乐播放urlAction\n\nconst changeCurrentSongPlayUrlAction = res => ({\n  type: actionTypes.CHANGE_CURRENT_SONG_PLAY_URL,\n  currentSongPlayUrl: res.data[0]\n});\n\nexport const getSongPlayUrlAction = id => {\n  return dispatch => {\n    getSongPlayUrl(id).then(res => {\n      dispatch(changeCurrentSongPlayUrlAction(res));\n    });\n  };\n};","map":{"version":3,"sources":["/Users/jr/myWeb/React项目实战/music163_jr/src/pages/player/store/actionCreator.js"],"names":["actionTypes","getSongDetail","getSongPlayUrl","changeCurrentSongAction","res","type","CHANGE_CURRENT_SONG","currentSong","changeSongIndexAction","CHANGE_CURRENT_SONG_INDEX","currentSongIndex","changePlayListAction","CHANGE_PLAY_LIST","playList","getSongDetailAction","id","dispatch","getState","player","songIndex","findIndex","song","then","songs","push","length","changeCurrentSongPlayUrlAction","CHANGE_CURRENT_SONG_PLAY_URL","currentSongPlayUrl","data","getSongPlayUrlAction"],"mappings":"AAAA,OAAO,KAAKA,WAAZ,MAA6B,eAA7B;AACA,SAAQC,aAAR,EAAsBC,cAAtB,QAA2C,kBAA3C,C,CAEA;;AACA,MAAMC,uBAAuB,GAAGC,GAAG,KAAI;AACnCC,EAAAA,IAAI,EAACL,WAAW,CAACM,mBADkB;AAEnCC,EAAAA,WAAW,EAACH;AAFuB,CAAJ,CAAnC,C,CAIA;;;AACA,MAAMI,qBAAqB,GAAGJ,GAAG,KAAI;AACjCC,EAAAA,IAAI,EAACL,WAAW,CAACS,yBADgB;AAEjCC,EAAAA,gBAAgB,EAACN;AAFgB,CAAJ,CAAjC,C,CAIA;;;AACA,MAAMO,oBAAoB,GAAGP,GAAG,KAAI;AAChCC,EAAAA,IAAI,EAACL,WAAW,CAACY,gBADe;AAEhCC,EAAAA,QAAQ,EAACT;AAFuB,CAAJ,CAAhC;;AAKA,OAAO,MAAMU,mBAAmB,GAAIC,EAAD,IAAO;AACtC,SAAO,CAACC,QAAD,EAAUC,QAAV,KAAuB;AAC1B;AACA,UAAMJ,QAAQ,GAAGI,QAAQ,GAAGC,MAAX,CAAkBL,QAAnC;AACA,UAAMM,SAAS,GAAGN,QAAQ,CAACO,SAAT,CAAmBC,IAAI,IAAIA,IAAI,CAACN,EAAL,KAAUA,EAArC,CAAlB;;AAEA,QAAGI,SAAS,KAAK,CAAC,CAAlB,EAAoB;AAChB;AACAH,MAAAA,QAAQ,CAACR,qBAAqB,CAACW,SAAD,CAAtB,CAAR;AACAhB,MAAAA,uBAAuB,CAACU,QAAQ,CAACM,SAAD,CAAT,CAAvB;AACH,KAJD,MAIK;AACD;AACA;AACAlB,MAAAA,aAAa,CAACc,EAAD,CAAb,CAAkBO,IAAlB,CAAuBlB,GAAG,IAAI;AAC1B,cAAMiB,IAAI,GAAGjB,GAAG,CAACmB,KAAJ,IAAanB,GAAG,CAACmB,KAAJ,CAAU,CAAV,CAA1B;AACAV,QAAAA,QAAQ,CAACW,IAAT,CAAcH,IAAd;AACAL,QAAAA,QAAQ,CAACL,oBAAoB,CAACE,QAAD,CAArB,CAAR;AACA,YAAIM,SAAS,GAAGN,QAAQ,CAACY,MAAT,GAAgB,CAAhC;AACAT,QAAAA,QAAQ,CAACR,qBAAqB,CAACW,SAAD,CAAtB,CAAR;AACAH,QAAAA,QAAQ,CAACb,uBAAuB,CAACU,QAAQ,CAACM,SAAD,CAAT,CAAxB,CAAR;AACH,OAPD;AASH;AACJ,GAtBD;AAuBH,CAxBM,C,CA0BP;;AACA,MAAMO,8BAA8B,GAAGtB,GAAG,KAAK;AAC3CC,EAAAA,IAAI,EAACL,WAAW,CAAC2B,4BAD0B;AAE3CC,EAAAA,kBAAkB,EAACxB,GAAG,CAACyB,IAAJ,CAAS,CAAT;AAFwB,CAAL,CAA1C;;AAKA,OAAO,MAAMC,oBAAoB,GAAGf,EAAE,IAAG;AACrC,SAAOC,QAAQ,IAAI;AACfd,IAAAA,cAAc,CAACa,EAAD,CAAd,CAAmBO,IAAnB,CAAyBlB,GAAD,IAAS;AAC7BY,MAAAA,QAAQ,CAACU,8BAA8B,CAACtB,GAAD,CAA/B,CAAR;AACH,KAFD;AAGH,GAJD;AAKH,CANM","sourcesContent":["import * as actionTypes from './actionTypes';\nimport {getSongDetail,getSongPlayUrl} from '@/service/player';\n\n// 歌曲详情Action\nconst changeCurrentSongAction = res =>({\n    type:actionTypes.CHANGE_CURRENT_SONG,\n    currentSong:res\n})\n// 当前歌曲索引Action\nconst changeSongIndexAction = res =>({\n    type:actionTypes.CHANGE_CURRENT_SONG_INDEX,\n    currentSongIndex:res\n})\n// 歌曲列表Action\nconst changePlayListAction = res =>({\n    type:actionTypes.CHANGE_PLAY_LIST,\n    playList:res\n})\n\nexport const getSongDetailAction = (id) =>{\n    return (dispatch,getState) => {\n        // 1、根据id查找palyList里是否有该歌曲\n        const playList = getState().player.playList;\n        const songIndex = playList.findIndex(song => song.id===id);\n        \n        if(songIndex !== -1){\n            // 2、找到歌曲\n            dispatch(changeSongIndexAction(songIndex));\n            changeCurrentSongAction(playList[songIndex])\n        }else{\n            // 3、没找到歌曲\n            // 请求数据\n            getSongDetail(id).then(res => {\n                const song = res.songs && res.songs[0];\n                playList.push(song);\n                dispatch(changePlayListAction(playList));\n                let songIndex = playList.length-1;\n                dispatch(changeSongIndexAction(songIndex));\n                dispatch(changeCurrentSongAction(playList[songIndex]));\n            });\n\n        }\n    }\n}\n\n// 歌曲音乐播放urlAction\nconst changeCurrentSongPlayUrlAction = res => ({\n    type:actionTypes.CHANGE_CURRENT_SONG_PLAY_URL,\n    currentSongPlayUrl:res.data[0]\n})\n\nexport const getSongPlayUrlAction = id =>{\n    return dispatch => {\n        getSongPlayUrl(id).then((res) => {\n            dispatch(changeCurrentSongPlayUrlAction(res));\n        });\n    }\n}\n"]},"metadata":{},"sourceType":"module"}