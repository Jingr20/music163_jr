{"ast":null,"code":"import { gotoPhoneLogin } from '@/service/login';\nimport * as actionTypes from './actionTypes';\nimport md5 from 'js-md5';\nimport { message } from 'antd';\nimport loginInfo from '@/config/token';\nimport { getLoginInfo, setLoginInfo } from '@/utils/secret-key'; // 更改登录框显示\n\nexport const changeIsVisible = res => ({\n  type: actionTypes.CHANGE_IS_VISIBLE_STATE,\n  isVisible: res\n}); // 更改登录状态\n\nexport const changeUserLoginState = res => ({\n  type: actionTypes.CHANGE_USER_LOGIN_STATE,\n  isLogin: res\n}); // 更改登录用户信息\n\nexport const changeUserProfile = res => ({\n  type: actionTypes.CHANGE_PROFILE_INFO,\n  profile: res\n}); // 更改登录状态(token)\n\nexport const changeUserLoginToken = res => ({\n  type: actionTypes.CHANGE_PROFILE_TOKEN,\n  token: res\n}); // 更改登录状态(cookie)\n\nexport const changeUserLoginCookie = res => ({\n  type: actionTypes.CHANGE_PROFILE_COOKIE,\n  cookie: res\n}); // 获取登录信息\n\nexport const getLoginProfileInfo = (username, password, tip) => {\n  return dispatch => {\n    gotoPhoneLogin(username, undefined, md5(password)).then(res => {\n      // gotoPhoneLogin(username,password).then((res)=>{\n      console.log(res);\n\n      if (res.code !== 200) {\n        message.error('账号或密码错误');\n      } else {\n        // 登录成功\n        document.cookie = res.cookie; // 保存用户信息\n\n        dispatch(changeUserProfile(res && res.profile)); // 更改登录状态\n\n        dispatch(changeUserLoginState(true));\n        dispatch(changeUserLoginToken(res.token));\n        dispatch(changeUserLoginCookie(res.cookie)); // 保存登录信息(以便于下次自动登录)\n\n        loginInfo.username = username;\n        loginInfo.password = password;\n        loginInfo.state = true;\n        let newLoginInfo = Object.assign(getLoginInfo('loginInfo'), loginInfo);\n        setLoginInfo('loginInfo', newLoginInfo); // console.log(getLoginInfo('loginInfo'));\n\n        console.log(localStorage); // 关闭对话框\n\n        dispatch(changeIsVisible(false));\n      }\n    });\n  };\n};","map":{"version":3,"sources":["/Users/jr/myWeb/React项目实战/music163_jr/src/components/theme-login/store/actionCreator.js"],"names":["gotoPhoneLogin","actionTypes","md5","message","loginInfo","getLoginInfo","setLoginInfo","changeIsVisible","res","type","CHANGE_IS_VISIBLE_STATE","isVisible","changeUserLoginState","CHANGE_USER_LOGIN_STATE","isLogin","changeUserProfile","CHANGE_PROFILE_INFO","profile","changeUserLoginToken","CHANGE_PROFILE_TOKEN","token","changeUserLoginCookie","CHANGE_PROFILE_COOKIE","cookie","getLoginProfileInfo","username","password","tip","dispatch","undefined","then","console","log","code","error","document","state","newLoginInfo","Object","assign","localStorage"],"mappings":"AAAA,SAASA,cAAT,QAA+B,iBAA/B;AACA,OAAO,KAAKC,WAAZ,MAA6B,eAA7B;AACA,OAAOC,GAAP,MAAgB,QAAhB;AACA,SAAQC,OAAR,QAAsB,MAAtB;AACA,OAAOC,SAAP,MAAsB,gBAAtB;AACA,SAASC,YAAT,EAAwBC,YAAxB,QAA2C,oBAA3C,C,CAEA;;AACA,OAAO,MAAMC,eAAe,GAAGC,GAAG,KAAK;AACnCC,EAAAA,IAAI,EAACR,WAAW,CAACS,uBADkB;AAEnCC,EAAAA,SAAS,EAACH;AAFyB,CAAL,CAA3B,C,CAKP;;AACA,OAAO,MAAMI,oBAAoB,GAAGJ,GAAG,KAAK;AACxCC,EAAAA,IAAI,EAACR,WAAW,CAACY,uBADuB;AAExCC,EAAAA,OAAO,EAACN;AAFgC,CAAL,CAAhC,C,CAKP;;AACA,OAAO,MAAMO,iBAAiB,GAAGP,GAAG,KAAK;AACrCC,EAAAA,IAAI,EAAER,WAAW,CAACe,mBADmB;AAErCC,EAAAA,OAAO,EAAET;AAF4B,CAAL,CAA7B,C,CAKP;;AACA,OAAO,MAAMU,oBAAoB,GAAGV,GAAG,KAAK;AACxCC,EAAAA,IAAI,EAAER,WAAW,CAACkB,oBADsB;AAExCC,EAAAA,KAAK,EAACZ;AAFkC,CAAL,CAAhC,C,CAKP;;AACA,OAAO,MAAMa,qBAAqB,GAAGb,GAAG,KAAK;AACzCC,EAAAA,IAAI,EAAER,WAAW,CAACqB,qBADuB;AAEzCC,EAAAA,MAAM,EAACf;AAFkC,CAAL,CAAjC,C,CAKP;;AACA,OAAO,MAAMgB,mBAAmB,GAAG,CAACC,QAAD,EAAWC,QAAX,EAAqBC,GAArB,KAA2B;AAC1D,SAAOC,QAAQ,IAAG;AACd5B,IAAAA,cAAc,CAACyB,QAAD,EAAUI,SAAV,EAAoB3B,GAAG,CAACwB,QAAD,CAAvB,CAAd,CAAiDI,IAAjD,CAAuDtB,GAAD,IAAO;AAC7D;AACIuB,MAAAA,OAAO,CAACC,GAAR,CAAYxB,GAAZ;;AACA,UAAGA,GAAG,CAACyB,IAAJ,KAAa,GAAhB,EAAoB;AAChB9B,QAAAA,OAAO,CAAC+B,KAAR,CAAc,SAAd;AACH,OAFD,MAEK;AACD;AACAC,QAAAA,QAAQ,CAACZ,MAAT,GAAkBf,GAAG,CAACe,MAAtB,CAFC,CAGD;;AACAK,QAAAA,QAAQ,CAACb,iBAAiB,CAACP,GAAG,IAAIA,GAAG,CAACS,OAAZ,CAAlB,CAAR,CAJC,CAKD;;AACAW,QAAAA,QAAQ,CAAChB,oBAAoB,CAAC,IAAD,CAArB,CAAR;AACAgB,QAAAA,QAAQ,CAACV,oBAAoB,CAACV,GAAG,CAACY,KAAL,CAArB,CAAR;AACAQ,QAAAA,QAAQ,CAACP,qBAAqB,CAACb,GAAG,CAACe,MAAL,CAAtB,CAAR,CARC,CAUD;;AACAnB,QAAAA,SAAS,CAACqB,QAAV,GAAqBA,QAArB;AACArB,QAAAA,SAAS,CAACsB,QAAV,GAAqBA,QAArB;AACAtB,QAAAA,SAAS,CAACgC,KAAV,GAAkB,IAAlB;AAEA,YAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAclC,YAAY,CAAC,WAAD,CAA1B,EAAyCD,SAAzC,CAAnB;AACAE,QAAAA,YAAY,CAAC,WAAD,EAAc+B,YAAd,CAAZ,CAhBC,CAiBD;;AACAN,QAAAA,OAAO,CAACC,GAAR,CAAYQ,YAAZ,EAlBC,CAmBD;;AACAZ,QAAAA,QAAQ,CAACrB,eAAe,CAAC,KAAD,CAAhB,CAAR;AACH;AACJ,KA3BD;AA4BH,GA7BD;AA8BH,CA/BM","sourcesContent":["import { gotoPhoneLogin } from '@/service/login';\nimport * as actionTypes from './actionTypes';\nimport md5 from 'js-md5';\nimport {message} from 'antd';\nimport loginInfo from '@/config/token';\nimport { getLoginInfo , setLoginInfo} from '@/utils/secret-key'\n\n// 更改登录框显示\nexport const changeIsVisible = res => ({\n    type:actionTypes.CHANGE_IS_VISIBLE_STATE,\n    isVisible:res\n})\n\n// 更改登录状态\nexport const changeUserLoginState = res => ({\n    type:actionTypes.CHANGE_USER_LOGIN_STATE,\n    isLogin:res\n})\n\n// 更改登录用户信息\nexport const changeUserProfile = res => ({\n    type: actionTypes.CHANGE_PROFILE_INFO,\n    profile: res\n})\n\n// 更改登录状态(token)\nexport const changeUserLoginToken = res => ({\n    type: actionTypes.CHANGE_PROFILE_TOKEN,\n    token:res\n})\n\n// 更改登录状态(cookie)\nexport const changeUserLoginCookie = res => ({\n    type: actionTypes.CHANGE_PROFILE_COOKIE,\n    cookie:res\n})\n\n// 获取登录信息\nexport const getLoginProfileInfo = (username, password, tip)=>{\n    return dispatch =>{\n        gotoPhoneLogin(username,undefined,md5(password)).then((res)=>{\n        // gotoPhoneLogin(username,password).then((res)=>{\n            console.log(res);\n            if(res.code !== 200){\n                message.error('账号或密码错误')\n            }else{\n                // 登录成功\n                document.cookie = res.cookie;\n                // 保存用户信息\n                dispatch(changeUserProfile(res && res.profile));\n                // 更改登录状态\n                dispatch(changeUserLoginState(true))\n                dispatch(changeUserLoginToken(res.token))\n                dispatch(changeUserLoginCookie(res.cookie))\n\n                // 保存登录信息(以便于下次自动登录)\n                loginInfo.username = username;\n                loginInfo.password = password;\n                loginInfo.state = true;\n\n                let newLoginInfo = Object.assign(getLoginInfo('loginInfo'), loginInfo)\n                setLoginInfo('loginInfo', newLoginInfo);\n                // console.log(getLoginInfo('loginInfo'));\n                console.log(localStorage);\n                // 关闭对话框\n                dispatch(changeIsVisible(false))\n            }\n        });\n    }\n}\n  \n\n"]},"metadata":{},"sourceType":"module"}